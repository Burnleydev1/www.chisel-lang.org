<html><head><title>Chisel/FIRRTL: Experimental Features</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="the Chisel/FIRRTL Developers" /><meta name="description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="Chisel/FIRRTL: Experimental Features" /><meta name="title" property="og:title" content="Chisel/FIRRTL: Experimental Features" /><meta name="og:site_name" content="Chisel/FIRRTL" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="Chisel/FIRRTL: Experimental Features" /><meta name="twitter:image" content="https://www.chisel-lang.org/img/poster.png" /><meta name="twitter:description" content="Chisel/FIRRTL
Hardware Compiler Framework" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@chisel_lang" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/default.css" /><link rel="stylesheet" href="/css/style.css" /><link rel="stylesheet" href="/css/palette.css" /><link rel="stylesheet" href="/css/codemirror.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145179088-1' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>Chisel/FIRRTL</span></div></a></li> <li><a href="/chisel3/" class="">Chisel3</a></li> <li><a href="/chisel3/cookbooks.html" class="">Cookbooks</a> <ul class="sub_section"> <li><a href="/chisel3/docs/cookbooks/naming.html" class="">Naming</a></li></ul></li> <li><a href="/chisel3/explanations.html" class="">Explanations</a> <ul class="sub_section"> <li><a href="/chisel3/docs/explanations/annotations.html" class="">Annotations</a></li> <li><a href="/chisel3/docs/explanations/blackboxes.html" class="">Blackboxes</a></li> <li><a href="/chisel3/docs/explanations/bundles-and-vecs.html" class="">Bundles and Vecs</a></li> <li><a href="/chisel3/docs/explanations/multi-clock.html" class="">Multiple Clock Domains</a></li> <li><a href="/chisel3/docs/explanations/naming.html" class="">Naming</a></li></ul></li> <li><a href="/chisel3/wiki-deprecated.html" class="">Wiki (Deprecated)</a> <ul class="sub_section"> <li><a href="/chisel3/docs/wiki-deprecated/introduction.html" class="">Introduction</a></li> <li><a href="/chisel3/docs/wiki-deprecated/supported-hardware.html" class="">Supported Hardware</a></li> <li><a href="/chisel3/docs/wiki-deprecated/data-types.html" class="">Data Types</a></li> <li><a href="/chisel3/docs/wiki-deprecated/combinational-circuits.html" class="">Combinational Circuits</a></li> <li><a href="/chisel3/docs/wiki-deprecated/operators.html" class="">Operators</a></li> <li><a href="/chisel3/docs/wiki-deprecated/width-inference.html" class="">Width Inference</a></li> <li><a href="/chisel3/docs/wiki-deprecated/functional-abstraction.html" class="">Functional Abstraction</a></li> <li><a href="/chisel3/docs/wiki-deprecated/ports.html" class="">Ports</a></li> <li><a href="/chisel3/docs/wiki-deprecated/modules.html" class="">Modules</a></li> <li><a href="/chisel3/docs/wiki-deprecated/sequential-circuits.html" class="">Sequential Circuits</a></li> <li><a href="/chisel3/docs/wiki-deprecated/memories.html" class="">Memories</a></li> <li><a href="/chisel3/docs/wiki-deprecated/interfaces-and-connections.html" class="">Interfaces and Connections</a></li> <li><a href="/chisel3/docs/wiki-deprecated/functional-module-creation.html" class="">Functional Module Creation</a></li> <li><a href="/chisel3/docs/wiki-deprecated/muxes-and-input-selection.html" class="">Muxes and Input Selection</a></li> <li><a href="/chisel3/docs/wiki-deprecated/polymorphism-and-parameterization.html" class="">Polymorphism and Parameterization</a></li> <li><a href="/chisel3/docs/wiki-deprecated/printing.html" class="">Printing in Chisel</a></li> <li><a href="/chisel3/docs/wiki-deprecated/unconnected-wires.html" class="">Unconnected Wires</a></li> <li><a href="/chisel3/docs/wiki-deprecated/reset.html" class="">Reset</a></li> <li><a href="/chisel3/docs/wiki-deprecated/chisel3-vs-chisel2.html" class="">Appendix</a></li></ul></li> <li><a href="/chisel3/developers.html" class="">Developers</a> <ul class="sub_section"> <li><a href="/chisel3/sbt-subproject.html" class="">sbt Subproject</a></li> <li><a href="/chisel3/test-coverage.html" class="">Test Coverage</a></li></ul></li> <li><a href="/api/latest/" class="">API Documentation</a> <ul class="sub_section"> <li><a href="/api/SNAPSHOT/" class="">SNAPSHOT</a></li> <li><a href="/api/3.4.0/" class="">3.4.0</a></li> <li><a href="/api/3.3.2/" class="">3.3.2</a></li> <li><a href="/api/3.3.1/" class="">3.3.1</a></li> <li><a href="/api/3.3.0/" class="">3.3.0</a></li> <li><a href="/api/3.2.7/" class="">3.2.7</a></li> <li><a href="/api/3.2.6/" class="">3.2.6</a></li> <li><a href="/api/3.2.5/" class="">3.2.5</a></li> <li><a href="/api/3.2.4/" class="">3.2.4</a></li> <li><a href="/api/3.2.3/" class="">3.2.3</a></li> <li><a href="/api/3.2.2/" class="">3.2.2</a></li> <li><a href="/api/3.2.1/" class="">3.2.1</a></li> <li><a href="/api/3.2.0/" class="">3.2.0</a></li> <li><a href="/api/3.1.8/" class="">3.1.8</a></li> <li><a href="/api/3.1.7/" class="">3.1.7</a></li> <li><a href="/api/3.1.6/" class="">3.1.6</a></li> <li><a href="/api/3.1.5/" class="">3.1.5</a></li> <li><a href="/api/3.1.4/" class="">3.1.4</a></li> <li><a href="/api/3.1.3/" class="">3.1.3</a></li> <li><a href="/api/3.1.2/" class="">3.1.2</a></li> <li><a href="/api/3.1.1/" class="">3.1.1</a></li> <li><a href="/api/3.1.0/" class="">3.1.0</a></li> <li><a href="/api/3.0.2/" class="">3.0.2</a></li> <li><a href="/api/3.0.1/" class="">3.0.1</a></li> <li><a href="/api/3.0.0/" class="">3.0.0</a></li></ul></li>            </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"></ul></div></div></div></div><div id="content" data-github-owner="freechipsproject" data-github-repo="chisel3"><div class="content-wrapper"><section><p>Chisel has a number of new features that are worth checking out.  This page is an informal list of these features and projects.</p>

<h3 id="fixedpoint">FixedPoint</h3>

<p>FixedPoint numbers are basic <em>Data</em> type along side of UInt, SInt, etc.  Most common math and logic operations
are supported. Chisel allows both the width and binary point to be inferred by the Firrtl compiler which can simplify
circuit descriptions. See <a href="https://github.com/freechipsproject/chisel3/tree/master/src/test/scala/chiselTests/FixedPointSpec.scala">FixedPointSpec</a></p>

<h3 id="module-variants">Module Variants</h3>

<p>The standard Chisel <em>Module</em> requires a <code class="highlighter-rouge">val io = IO(...)</code>, the experimental package introduces several
new ways of defining Modules</p>
<ul>
  <li>BaseModule: no contents, instantiable</li>
  <li>BlackBox extends BaseModule</li>
  <li>UserDefinedModule extends BaseModule: this module can contain Chisel RTL. No default clock or reset lines. No default IO. - User should be able to specify non-io ports, ideally multiple of them.</li>
  <li>ImplicitModule extends UserModule: has clock, reset, and io, essentially current Chisel Module.</li>
  <li>RawModule: will be the user-facing version of UserDefinedModule</li>
  <li>Module: type-aliases to ImplicitModule, the user-facing version of ImplicitModule.</li>
</ul>

<h3 id="bundle-literals">Bundle Literals</h3>

<p>Chisel 3.2 introduces an experimental mechanism for Bundle literals in #820, but this feature is largely incomplete and not ready for user code yet. The following is provided as documentation for library writers who want to take a stab at using this mechanism for their library’s bundles.</p>

<p>```mdoc scala
class MyBundle extends Bundle {
  val a = UInt(8.W)
  val b = Bool()</p>

<p>// Bundle literal constructor code, which will be auto-generated using macro annotations in
  // the future.
  import chisel3.core.BundleLitBinding
  import chisel3.internal.firrtl.{ULit, Width}</p>

<p>// Full bundle literal constructor
  def Lit(aVal: UInt, bVal: Bool): MyBundle = {
    val clone = cloneType
    clone.selfBind(BundleLitBinding(Map(
      clone.a -&gt; litArgOfBits(aVal),
      clone.b -&gt; litArgOfBits(bVal)
    )))
    clone
  }</p>

<p>// Partial bundle literal constructor
  def Lit(aVal: UInt): MyBundle = {
    val clone = cloneType
    clone.selfBind(BundleLitBinding(Map(
      clone.a -&gt; litArgOfBits(aVal)
    )))
    clone
  }
}</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Example usage:

```scala
val outsideBundleLit = (new MyBundle).Lit(42.U, true.B)
</code></pre></div></div>

<h3 id="interval-type">Interval Type</h3>

<p><strong>Intervals</strong> are a new experimental numeric type that comprises UInt, SInt and FixedPoint numbers.
It augments these types with range information, i.e. upper and lower numeric bounds.
This information can be used to exercise tighter programmatic control over the ultimate widths of
signals in the final circuit.  The <strong>Firrtl</strong> compiler can infer this range information based on
operations and earlier values in the circuit. Intervals support all the ordinary bit and arithmetic operations
associated with UInt, SInt, and FixedPoint and adds the following methods for manipulating the range of
a <strong>source</strong> Interval with the IntervalRange of <strong>target</strong> Interval</p>

<h4 id="clip--fit-the-value-source-into-the-intervalrange-of-target-saturate-if-out-of-bounds">Clip – Fit the value <strong>source</strong> into the IntervalRange of <strong>target</strong>, saturate if out of bounds</h4>

<p>The clip method applied to an interval creates a new interval based on the argument to clip,
and constructs the necessary hardware so that the source Interval’s value will be mapped into the new Interval.
Values that are outside the result range will be pegged to either maximum or minimum of result range as appropriate.</p>

<blockquote>
  <p>Generates necessary hardware to clip values, values greater than range are set to range.high, values lower than range are set to range min.</p>
</blockquote>

<h4 id="wrap--fit-the-value-source-into-the-intervalrange-of-target-wrapping-around-if-out-of-bounds">Wrap – Fit the value <strong>source</strong> into the IntervalRange of <strong>target</strong>, wrapping around if out of bounds</h4>

<p>The wrap method applied to an interval creates a new interval based on the argument to wrap,
and constructs the necessary
hardware so that the source Interval’s value will be mapped into the new Interval.
Values that are outside the result range will be wrapped until they fall within the result range.</p>

<blockquote>
  <p>Generates necessary hardware to wrap values, values greater than range are set to range.high, values lower than range are set to range min.</p>
</blockquote>

<blockquote>
  <p>Does not handle out of range values that are less than half the minimum or greater than twice maximum</p>
</blockquote>

<h4 id="squeeze--fit-the-value-source-into-the-smallest-intervalrange-based-on-source-and-target">Squeeze – Fit the value <strong>source</strong> into the smallest IntervalRange based on source and target.</h4>

<p>The squeeze method applied to an interval creates a new interval based on the argument to clip, the two ranges must overlap
behavior of squeeze with inputs outside of the produced range is undefined.</p>

<blockquote>
  <p>Generates no hardware, strictly a sizing operation</p>
</blockquote>

<h5 id="range-combinations">Range combinations</h5>

<table>
  <thead>
    <tr>
      <th>Condition</th>
      <th>A.clip(B)</th>
      <th>A.wrap(B)</th>
      <th>A.squeeze(B)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A === B</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
    </tr>
    <tr>
      <td>A contains B</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
    </tr>
    <tr>
      <td>B contains A</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
    </tr>
    <tr>
      <td>A min &lt; B min, A max in B</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
    </tr>
    <tr>
      <td>A min in B, A max &gt; B max</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
      <td>max(Alo, Blo), min(Ahi, Bhi)</td>
    </tr>
    <tr>
      <td>A strictly less than B</td>
      <td>error</td>
      <td>error</td>
      <td>error</td>
    </tr>
    <tr>
      <td>A strictly greater than B</td>
      <td>error</td>
      <td>error</td>
      <td>error</td>
    </tr>
  </tbody>
</table>

<h4 id="applying-binary-point-operators-to-an-interval">Applying binary point operators to an Interval</h4>

<p>Consider a Interval with a binary point of 3: aaa.bbb</p>

<table>
  <thead>
    <tr>
      <th>operation</th>
      <th>after operation</th>
      <th>binary point</th>
      <th>lower</th>
      <th>upper</th>
      <th>meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>setBinaryPoint(2)</td>
      <td>aaa.bb</td>
      <td>2</td>
      <td>X</td>
      <td>X</td>
      <td>set the precision</td>
    </tr>
    <tr>
      <td>shiftLeftBinaryPoint(2)</td>
      <td>a.aabbb</td>
      <td>5</td>
      <td>X</td>
      <td>X</td>
      <td>increase the precision</td>
    </tr>
    <tr>
      <td>shiftRighBinaryPoint(2)</td>
      <td>aaaa.b</td>
      <td>1</td>
      <td>X</td>
      <td>X</td>
      <td>reduce the precision</td>
    </tr>
  </tbody>
</table>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script>((window.gitter = {}).chat = {}).options = {
room: 'freechipsproject/chisel3'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/js/main.js"></script></body></html>